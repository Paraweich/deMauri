<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>San Valent√≠n</title>
<style>
    body {
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: linear-gradient(135deg, #ffebee 0%, #ffcccb 40%, #ff80ab 70%, #e91e63 100%);
        font-family: Arial, sans-serif;
        overflow: hidden;
        position: relative;
    }
    .heart-rain {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
        overflow: hidden;
    }
    .heart {
        position: absolute;
        font-size: 20px;
        color: #ff69b4;
        opacity: 0.7;
        top: -50px;
        will-change: transform;
        animation: rain linear infinite;
    }
    .heart:nth-child(odd) { 
        color: #c2185b; 
        font-size: 18px; 
    }
    .heart:nth-child(3n) { 
        color: #ff80ab; 
        font-size: 25px; 
        opacity: 0.9; 
    }
    @keyframes rain {
        0% { 
            transform: translateY(0) rotate(0deg); 
            opacity: 0;
        }
        10% {
            opacity: 0.7;
        }
        90% {
            opacity: 0.7;
        }
        100% { 
            transform: translateY(calc(100vh + 100px)) rotate(720deg); 
            opacity: 0;
        }
    }
    .card {
        background: white;
        padding: 40px;
        border-radius: 25px;
        box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        text-align: center;
        width: 420px;
        max-width: 90%;
        position: relative;
        z-index: 10;
        overflow: hidden;
    }
    h1 {
        color: #c2185b;
        font-size: 28px;
        margin-bottom: 10px;
    }
    #textoNo {
        display: none;
        color: #d81b60;
        font-weight: bold;
        margin-top: 15px;
        font-size: 18px;
    }
    img {
        border-radius: 15px;
        margin: 20px auto;
        display: block;
    }
    #imgGif {
        width: 232px !important;
        height: 234px !important;
        object-fit: contain;
        background: #fff;
    }
    .btn-container {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-top: 30px;
    }
    button {
        padding: 14px 35px;
        font-size: 20px;
        font-weight: bold;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: transform 0.4s ease, opacity 0.8s ease;
        position: relative;
    }
    #btnSi {
        background-color: #f06292;
        color: white;
    }
    #btnNo {
        background-color: #90a4ae;
        color: white;
        position: relative;
        transition: left 0.5s ease-out, top 0.5s ease-out, transform 0.3s ease;
        pointer-events: auto;
        z-index: 999;
    }
    #btnNo.moving {
        transition: left 0.25s linear, top 0.25s linear, transform 0.3s ease;
        position: fixed !important;
    }
    .mini-si {
        position: absolute;
        font-size: 1.4rem;
        font-weight: bold;
        color: #f06292;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        pointer-events: none;
        z-index: 1000;
        animation: flyOut 4s forwards;
    }
    @keyframes flyOut {
        0% { opacity: 1; transform: scale(0.6) translate(0,0); }
        100% { opacity: 0; transform: scale(2) translate(var(--tx), var(--ty)); }
    }
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
        20%, 40%, 60%, 80% { transform: translateX(10px); }
    }
    .card-content {
        position: relative;
    }
    .card-content.shake {
        animation: shake 0.5s ease-in-out;
    }
    .btn-si-flood {
        position: absolute;
        padding: 8px 18px;
        font-size: 14px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        color: white;
        z-index: 500;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        animation: riseAndFall 3s ease-out forwards;
    }
    @keyframes riseAndFall {
        0% {
            transform: translateY(500px);
            opacity: 0;
        }
        15% {
            opacity: 1;
        }
        40% {
            transform: translateY(-50px);
        }
        100% {
            transform: translateY(var(--fall-distance));
            opacity: 1;
        }
    }
</style>
</head>
<body>
<div class="heart-rain" id="heartRain"></div>
<div class="card">
    <div class="card-content">
        <h1 id="titulo">¬øQuieres ser mi San Valent√≠n? ‚ù§Ô∏è</h1>
        <p id="textoNo"></p>
      
        <img
            id="imgGif"
            src="https://i.ibb.co/Gfkxj1m4/Grabacindepantalla2026-02-08212818-ezgif-com-video-to-gif-converter.gif"
            alt="Gif inicial"
        >
    </div>
  
    <div class="btn-container">
        <button id="btnSi">¬°S√ç!</button>
        <button id="btnNo">No</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
// Funci√≥n para lanzar confetti
function lanzarConfetti() {
    const duracion = 3000;
    const fin = Date.now() + duracion;

    const colores = ['#f06292', '#ec407a', '#e91e63', '#c2185b', '#ff80ab', '#ff4081'];

    (function frame() {
        confetti({
            particleCount: 5,
            angle: 60,
            spread: 55,
            origin: { x: 0 },
            colors: colores
        });
        confetti({
            particleCount: 5,
            angle: 120,
            spread: 55,
            origin: { x: 1 },
            colors: colores
        });

        if (Date.now() < fin) {
            requestAnimationFrame(frame);
        }
    }());
}

// Lluvia de corazones mejorada
const heartRain = document.getElementById("heartRain");

function createHeart() {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.innerHTML = "‚ù§Ô∏è";
    heart.style.left = Math.random() * 100 + "%";
    heart.style.animationDuration = (Math.random() * 4 + 6) + "s";
    heart.style.animationDelay = Math.random() * 5 + "s";
    
    const randomOpacity = Math.random() * 0.4 + 0.4;
    heart.style.setProperty('opacity', randomOpacity);
    
    const randomSize = Math.random() * 15 + 15;
    heart.style.fontSize = randomSize + "px";
    
    heartRain.appendChild(heart);
    
    const duration = parseFloat(heart.style.animationDuration) * 1000;
    const delay = parseFloat(heart.style.animationDelay) * 1000;
    setTimeout(() => {
        heart.remove();
        createHeart();
    }, duration + delay);
}

for (let i = 0; i < 50; i++) {
    createHeart();
}

const btnNo = document.getElementById("btnNo");
const btnSi = document.getElementById("btnSi");
const textoNo = document.getElementById("textoNo");
const imgGif = document.getElementById("imgGif");
const container = document.body;
const cardContent = document.querySelector(".card-content");

let escalaSi = 1;
let escalaNo = 1;
let primeraVez = true;
let contadorNo = 0;
let isMovingMode = false;
let moveInterval = null;

function shakeCard() {
    cardContent.classList.add('shake');
    setTimeout(() => {
        cardContent.classList.remove('shake');
    }, 500);
}

function activarNo() {
    contadorNo++;
    textoNo.style.display = "block";
    
    shakeCard();

    if (contadorNo >= 5) {
        imgGif.src = "https://i.ibb.co/bjp4FSRr/STK-20240720-WA0017.webp";
        textoNo.innerHTML = "Solo bot√≥n S√≠ disponible üíï";
    } else if (contadorNo >= 4) {
        imgGif.src = "https://i.ibb.co/bjp4FSRr/STK-20240720-WA0017.webp";
        textoNo.innerHTML = "¬°YA BASTA POR FAVOR! üò≠üíî";
    } else if (contadorNo >= 3) {
        textoNo.innerHTML = "¬°YA BASTA! üíî ¬°AHORA TEN√âS QUE ATRAPARME! üî•";
        imgGif.src = "https://i.ibb.co/C5dZstcx/Grabacindepantalla2026-02-08212636-ezgif-com-video-to-gif-converter.gif";
        if (!isMovingMode) activarModoMovimientoLibre();
    } else if (contadorNo >= 2) {
        textoNo.innerHTML = "¬øPOR QU√â DECIS NO TODAVIA? üò≠üíî";
        imgGif.src = "https://i.ibb.co/C5dZstcx/Grabacindepantalla2026-02-08212636-ezgif-com-video-to-gif-converter.gif";
    } else {
        textoNo.innerHTML = "¬øPOR QU√â APRET√ÅS EL NO? üò≠";
        imgGif.src = "https://i.ibb.co/C5dZstcx/Grabacindepantalla2026-02-08212636-ezgif-com-video-to-gif-converter.gif";
    }

    imgGif.style.display = 'none';
    imgGif.offsetHeight;
    imgGif.style.display = 'block';

    escalaSi = escalaSi * 1.30;
    btnSi.style.transform = `scale(${escalaSi})`;

    if (contadorNo === 5) {
        escalaNo = 0.05;
        btnNo.style.transform = `scale(${escalaNo})`;
        btnNo.style.transition = 'transform 0.3s ease, left 0.15s linear, top 0.15s linear';
    } else {
        escalaNo = Math.max(0.3, escalaNo * 0.80);
        btnNo.style.transform = `scale(${escalaNo})`;
    }

    if (primeraVez && contadorNo >= 1) {
        btnNo.style.position = "fixed";
        btnNo.style.left = (window.innerWidth / 2 - btnNo.offsetWidth / 2) + 'px';
        btnNo.style.top = (window.innerHeight / 2 + 80) + 'px';
        primeraVez = false;
    }

    if (!isMovingMode && contadorNo < 3) {
        const x = Math.random() * (window.innerWidth - btnNo.offsetWidth - 100) + 50;
        const y = Math.random() * (window.innerHeight - btnNo.offsetHeight - 100) + 50;
        btnNo.style.left = `${x}px`;
        btnNo.style.top = `${y}px`;
    }

    // 5ta oprimida: explosi√≥n del bot√≥n S√≠ + lluvia de botones S√≠ que caen
    if (contadorNo === 5) {
        btnSi.style.transform = `scale(${escalaSi * 2})`;
        btnSi.style.opacity = '0';
        btnSi.style.transition = 'transform 0.7s ease-out, opacity 0.7s ease-out';
        btnSi.style.pointerEvents = 'none';

        setTimeout(() => {
            const card = document.querySelector('.card');
            const cardRect = card.getBoundingClientRect();
            
            const colores = ['#f06292', '#ec407a', '#e91e63', '#c2185b', '#ff80ab', '#ff4081', '#d81b60'];
            
            // Array para trackear posiciones ocupadas en la base
            let posicionesOcupadas = [];
            
            // Crear muchos botones S√≠ que suben y luego caen
            for (let i = 0; i < 120; i++) {
                setTimeout(() => {
                    const btnFlood = document.createElement('button');
                    btnFlood.className = 'btn-si-flood';
                    btnFlood.textContent = '¬°S√ç!';
                    
                    btnFlood.style.backgroundColor = colores[Math.floor(Math.random() * colores.length)];
                    
                    // Posici√≥n aleatoria en X dentro de la tarjeta
                    const randomX = Math.random() * (cardRect.width - 80);
                    btnFlood.style.left = randomX + 'px';
                    
                    // Calcular donde va a caer (en la base de la tarjeta)
                    // La base est√° a la altura del cardRect.height
                    // Queremos que se apilen, as√≠ que calculamos capas
                    const btnHeight = 35; // altura aproximada de cada bot√≥n
                    const capa = Math.floor(posicionesOcupadas.length / 10); // 10 botones por capa
                    const fallDistance = cardRect.height - 150 - (capa * btnHeight);
                    
                    btnFlood.style.setProperty('--fall-distance', `${fallDistance}px`);
                    
                    // Variaci√≥n en el delay para efecto escalonado
                    btnFlood.style.animationDelay = (i * 0.02) + 's';
                    
                    // Variaci√≥n en la duraci√≥n
                    btnFlood.style.animationDuration = (Math.random() * 0.5 + 2.5) + 's';
                    
                    posicionesOcupadas.push(randomX);
                    
                    // Al hacer clic en cualquier bot√≥n S√≠ de la inundaci√≥n
                    btnFlood.addEventListener('click', () => {
                        if (moveInterval) clearInterval(moveInterval);
                        lanzarConfetti();
                        document.body.innerHTML = `
                            <h1 style="color:#c2185b; text-align:center; margin-top:40vh; font-size:3em; text-shadow: 2px 2px 10px rgba(194,24,91,0.5); animation: pulse 1s ease-in-out infinite;">
                                ¬°SAB√çA QUE DIR√çAS QUE S√ç! üòç‚ù§Ô∏è
                            </h1>
                            <style>
                                @keyframes pulse {
                                    0%, 100% { transform: scale(1); }
                                    50% { transform: scale(1.05); }
                                }
                            </style>
                        `;
                    });
                    
                    card.appendChild(btnFlood);
                }, i * 15); // Crear botones escalonados
            }
        }, 300);
    }
    
    if (contadorNo === 6) {
        textoNo.innerHTML = "¬°Eleg√≠ cualquier S√ç! üíï";
    }
}

function activarModoMovimientoLibre() {
    isMovingMode = true;
    btnNo.classList.add('moving');
    let dx = (Math.random() > 0.5 ? 1 : -1) * (150 + Math.random() * 150);
    let dy = (Math.random() > 0.5 ? 1 : -1) * (80 + Math.random() * 80);
    
    let velocidadMultiplicador = contadorNo >= 5 ? 4.5 : 2.35;
    
    moveInterval = setInterval(() => {
        if (!isMovingMode) return;
        let currentLeft = parseFloat(btnNo.style.left) || window.innerWidth / 2;
        let currentTop = parseFloat(btnNo.style.top) || window.innerHeight / 2;
        currentLeft += dx * 0.016 * velocidadMultiplicador;
        currentTop += dy * 0.016 * velocidadMultiplicador;
        if (currentLeft < 30 || currentLeft > window.innerWidth - btnNo.offsetWidth - 30) {
            dx = -dx * (1.0 + Math.random() * 0.3);
            dy += (Math.random() - 0.5) * 20;
        }
        if (currentTop < 30 || currentTop > window.innerHeight - btnNo.offsetHeight - 30) {
            dy = -dy * (1.0 + Math.random() * 0.3);
            dx += (Math.random() - 0.5) * 40;
        }
        if (Math.random() < 0.06) {
            dx = (Math.random() > 0.5 ? 1 : -1) * (140 + Math.random() * 140);
            dy = (Math.random() > 0.5 ? 1 : -1) * (70 + Math.random() * 90);
        }
        btnNo.style.left = `${Math.max(30, Math.min(window.innerWidth - btnNo.offsetWidth - 30, currentLeft))}px`;
        btnNo.style.top = `${Math.max(30, Math.min(window.innerHeight - btnNo.offsetHeight - 30, currentTop))}px`;
    }, 12);
}

btnNo.addEventListener("click", activarNo);
btnNo.addEventListener("touchstart", (e) => {
    e.preventDefault();
    activarNo();
});

btnSi.addEventListener("click", () => {
    if (moveInterval) clearInterval(moveInterval);
    lanzarConfetti();
    document.body.innerHTML = `
        <h1 style="color:#c2185b; text-align:center; margin-top:40vh; font-size:3em; text-shadow: 2px 2px 10px rgba(194,24,91,0.5); animation: pulse 1s ease-in-out infinite;">
            ¬°SAB√çA QUE DIR√çAS QUE S√ç! üòç‚ù§Ô∏è
        </h1>
        <style>
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }
        </style>
    `;
});
</script>
</body>
</html>
