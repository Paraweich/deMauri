<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>San Valent√≠n</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
    body {
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: linear-gradient(135deg, #ffebee 0%, #ffcccb 40%, #ff80ab 70%, #e91e63 100%);
        font-family: 'Poppins', 'Segoe UI', Arial, sans-serif;
        overflow: hidden;
        position: relative;
    }
    .heart-rain {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
        overflow: hidden;
    }
    .heart {
        position: absolute;
        font-size: 20px;
        color: #ff69b4;
        opacity: 0.7;
        top: -50px;
        will-change: transform;
        animation: rain linear infinite;
    }
    .heart:nth-child(odd) { 
        color: #c2185b; 
        font-size: 18px; 
    }
    .heart:nth-child(3n) { 
        color: #ff80ab; 
        font-size: 25px; 
        opacity: 0.9; 
    }
    @keyframes rain {
        0% { 
            transform: translateY(0) rotate(0deg); 
            opacity: 0;
        }
        10% { opacity: 0.7; }
        90% { opacity: 0.7; }
        100% { 
            transform: translateY(calc(100vh + 100px)) rotate(720deg); 
            opacity: 0;
        }
    }
    .card {
        background: white;
        padding: 40px;
        border-radius: 25px;
        box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        text-align: center;
        width: 420px;
        max-width: 90%;
        position: relative;
        z-index: 10;
        overflow: hidden;
    }
    .card-grande {
        width: 500px !important;
    }
    h1 {
        color: #c2185b;
        font-size: 28px;
        margin-bottom: 10px;
    }
    #textoNo {
        display: none;
        color: #d81b60;
        font-weight: bold;
        margin-top: 15px;
        font-size: 18px;
    }
    img {
        border-radius: 15px;
        margin: 20px auto;
        display: block;
    }
    #imgGif {
        width: 232px !important;
        height: 234px !important;
        object-fit: contain;
        background: #fff;
    }
    .btn-container {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-top: 30px;
    }
    button {
        padding: 14px 35px;
        font-size: 20px;
        font-weight: bold;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: transform 0.4s ease, opacity 0.8s ease, box-shadow 0.2s ease;
        position: relative;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    button:hover {
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        transform: translateY(-2px);
    }
    button:active {
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        transform: translateY(1px);
    }
    #btnSi {
        background-color: #f06292;
        color: white;
        padding: 14px 35px;
        font-size: 18px;
        box-shadow: 0 4px 15px rgba(240, 98, 146, 0.4);
    }
    #btnSi:hover {
        box-shadow: 0 8px 25px rgba(240, 98, 146, 0.6);
    }
    #btnNo {
        background-color: #90a4ae;
        color: white;
        position: relative;
        transition: left 0.5s ease-out, top 0.5s ease-out, transform 0.3s ease, box-shadow 0.2s ease;
        pointer-events: auto;
        z-index: 999;
        padding: 14px 35px;
        font-size: 18px;
        box-shadow: 0 4px 15px rgba(144, 164, 174, 0.4);
    }
    #btnNo:hover {
        box-shadow: 0 8px 25px rgba(144, 164, 174, 0.6);
    }
    #btnNo.moving {
        transition: left 0.25s linear, top 0.25s linear, transform 0.3s ease;
        position: fixed !important;
    }
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
        20%, 40%, 60%, 80% { transform: translateX(10px); }
    }
    .card-content.shake {
        animation: shake 0.5s ease-in-out;
    }
    .btn-si-flood {
        position: absolute;
        padding: 8px 18px;
        font-size: 14px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        color: white;
        z-index: 500;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        will-change: transform, opacity;
        animation: fireworkExplosion 2.5s ease-out forwards;
    }
    @keyframes fireworkExplosion {
        0% { transform: translate(0, 0) scale(0.3) rotate(0deg); opacity: 0; }
        2% { opacity: 1; transform: translate(calc(var(--explode-x) * 0.03), calc(var(--explode-y) * 0.03)) scale(0.4) rotate(15deg); }
        5% { transform: translate(calc(var(--explode-x) * 0.08), calc(var(--explode-y) * 0.1)) scale(0.6) rotate(35deg); }
        8% { transform: translate(calc(var(--explode-x) * 0.15), calc(var(--explode-y) * 0.2)) scale(0.8) rotate(60deg); }
        12% { transform: translate(calc(var(--explode-x) * 0.23), calc(var(--explode-y) * 0.32 - 10px)) scale(0.95) rotate(95deg); }
        16% { transform: translate(calc(var(--explode-x) * 0.33), calc(var(--explode-y) * 0.45 - 18px)) scale(1) rotate(135deg); }
        20% { transform: translate(calc(var(--explode-x) * 0.43), calc(var(--explode-y) * 0.56 - 23px)) scale(1) rotate(180deg); }
        25% { transform: translate(calc(var(--explode-x) * 0.55), calc(var(--explode-y) * 0.64 - 28px)) scale(1) rotate(235deg); }
        30% { transform: translate(calc(var(--explode-x) * 0.67), calc(var(--explode-y) * 0.7 - 31px)) scale(1) rotate(295deg); }
        35% { transform: translate(calc(var(--explode-x) * 0.77), calc(var(--explode-y) * 0.72 - 32px)) scale(1) rotate(360deg); }
        40% { transform: translate(calc(var(--explode-x) * 0.86), calc(var(--explode-y) * 0.7 - 30px)) scale(1) rotate(430deg); }
        45% { transform: translate(calc(var(--explode-x) * 0.93), calc(var(--explode-y) * 0.64 - 25px)) scale(1) rotate(505deg); }
        50% { transform: translate(calc(var(--explode-x) * 0.97), calc(var(--explode-y) * 0.54 - 18px)) scale(1) rotate(580deg); }
        55% { transform: translate(calc(var(--explode-x) * 0.99), calc(var(--explode-y) * 0.4 - 8px)) scale(1) rotate(655deg); }
        60% { transform: translate(calc(var(--explode-x) * 1), calc(var(--explode-y) * 0.23 + 5px)) scale(1) rotate(730deg); }
        65% { transform: translate(calc(var(--explode-x) * 0.99), calc(var(--explode-y) * 0.05 + 20px)) scale(1) rotate(805deg); }
        70% { transform: translate(calc(var(--explode-x) * 0.96), calc(var(--explode-y) * -0.15 + 38px)) scale(1) rotate(880deg); }
        75% { transform: translate(calc(var(--final-x) * 0.5), calc(var(--final-y) * 0.35)) scale(1) rotate(955deg); }
        80% { transform: translate(calc(var(--final-x) * 0.7), calc(var(--final-y) * 0.55)) scale(1) rotate(1030deg); }
        85% { transform: translate(calc(var(--final-x) * 0.85), calc(var(--final-y) * 0.73)) scale(1) rotate(1105deg); }
        90% { transform: translate(calc(var(--final-x) * 0.94), calc(var(--final-y) * 0.87)) scale(1) rotate(1180deg); }
        95% { transform: translate(calc(var(--final-x) * 0.98), calc(var(--final-y) * 0.96)) scale(1) rotate(1255deg); }
        100% { transform: translate(var(--final-x), var(--final-y)) scale(1) rotate(var(--rotate)); opacity: 1; }
    }
    .pantalla {
        display: none !important;
        width: 100%;
        height: 100%;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
    }
    .pantalla.activa {
        display: flex !important;
        opacity: 1;
    }
    .pantalla.activa.zoom-in {
        animation: zoomIn 0.6s ease-out;
    }
    @keyframes zoomIn {
        0% {
            opacity: 0;
            transform: scale(0.8);
        }
        100% {
            opacity: 1;
            transform: scale(1);
        }
    }
</style>
</head>
<body>
<div class="heart-rain" id="heartRain"></div>

<!-- PANTALLA 0: Login -->
<div class="pantalla activa" id="pantalla0">
    <div class="card">
        <div class="card-content">
            <h1 style="color: #c2185b; font-size: 28px; margin-bottom: 20px;">üîê Acceso Exclusivo</h1>
            <p style="color: #d81b60; font-size: 16px; margin: 20px 0;">
                Solo personas autorizadas
            </p>
            <input 
                id="inputNombre" 
                type="text" 
                placeholder="Ingresa tu nombre completo"
                style="
                    width: 100%;
                    padding: 12px 15px;
                    font-size: 16px;
                    border: 2px solid #f06292;
                    border-radius: 10px;
                    font-family: 'Poppins', sans-serif;
                    box-sizing: border-box;
                    margin: 20px 0;
                    transition: all 0.3s ease;
                "
                onkeypress="if(event.key==='Enter') validarAcceso()"
            />
            <p id="mensajeError" style="color: #e91e63; font-size: 14px; display: none; font-weight: bold;"></p>
        </div>
        <div class="btn-container">
            <button id="btnEntrar" style="background-color: #f06292; color: white; padding: 14px 35px; font-size: 18px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer;">Entrar</button>
        </div>
    </div>
</div>

<!-- PANTALLA 1: Inicial -->
<div class="pantalla" id="pantalla1">
    <div class="card">
        <div class="card-content">
            <h1>¬øQuieres ser mi San Valent√≠n? ‚ù§Ô∏è</h1>
            <p id="textoNo"></p>
            <img id="imgGif" src="https://i.ibb.co/Gfkxj1m4/Grabacindepantalla2026-02-08212818-ezgif-com-video-to-gif-converter.gif" alt="Gif inicial">
        </div>
        <div class="btn-container">
            <button id="btnSi">¬°S√ç!</button>
            <button id="btnNo">No</button>
        </div>
    </div>
</div>

<!-- PANTALLA 2: Invitaci√≥n -->
<div class="pantalla" id="pantalla2">
    <div class="card">
        <div class="card-content">
            <h1 style="color: #c2185b; font-size: 32px;">¬°Est√°s invitada a una cita especial! üíï</h1>
        </div>
        <div class="btn-container">
            <button id="btnConfirmar" style="background-color: #f06292; color: white; padding: 10px 20px; font-size: 16px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer;">Confirmar Cita</button>
            <button id="btnMejorNo" style="background-color: #90a4ae; color: white; padding: 10px 20px; font-size: 16px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer;">¬°Iu mejor no!</button>
        </div>
    </div>
</div>

<!-- PANTALLA 3: Detalles de la cita -->
<div class="pantalla" id="pantalla3">
    <div class="card card-grande">
        <div class="card-content">
            <h1 style="color: #c2185b; font-size: 28px; margin-bottom: 20px;">üìç T√≠o Lucas</h1>
            <img src="https://i.ibb.co/VpYTtr53/Screenshot-2026-02-10-09-45-30-183-com-android-chrome.png" alt="T√≠o Lucas" style="border-radius: 15px; width: 100%; height: 250px; object-fit: cover; margin: 20px 0;">
            <div style="text-align: left; color: #666; font-size: 16px; line-height: 1.8;">
                <p><strong style="color: #c2185b;">üìÖ Fecha:</strong> 14 de febrero</p>
                <p><strong style="color: #c2185b;">üïò Hora:</strong> 21:30</p>
                <p><strong style="color: #c2185b;">üçΩÔ∏è Lugar:</strong> T√≠o Lucas, Asunci√≥n</p>
            </div>
            <p style="color: #d81b60; font-size: 18px; margin-top: 30px; font-weight: bold;">¬°Nos vemos el 14! üíï</p>
        </div>
        <div class="btn-container">
            <button id="btnVolverPantalla3" style="background-color: #f06292; color: white; padding: 8px 20px; font-size: 14px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer;">Volver</button>
        </div>
    </div>
</div>

<!-- PANTALLA 4: Se arrepinti√≥ -->
<div class="pantalla" id="pantalla4">
    <div class="card card-grande">
        <div class="card-content">
            <h1 style="color: #c2185b; font-size: 32px; margin-bottom: 30px;">¬øQue haces hoputa? üò≠</h1>
            <div style="display: flex; justify-content: center; gap: 30px; align-items: center;">
                <img src="https://i.ibb.co/kgxBjRMj/ezgif-com-animated-gif-maker-1.gif" alt="Gif triste 1" style="border-radius: 15px; width: 200px; height: 200px; object-fit: cover;">
                <img src="https://i.ibb.co/HfgcTF2h/ezgif-com-animated-gif-maker-2.gif" alt="Gif triste 2" style="border-radius: 15px; width: 200px; height: 200px; object-fit: cover;">
            </div>
        </div>
        <div class="btn-container">
            <button id="btnVolver" style="background-color: #f06292; color: white; padding: 8px 20px; font-size: 14px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer;">Volver</button>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {

const btnSi = document.getElementById('btnSi');
const btnNo = document.getElementById('btnNo');
const textoNo = document.getElementById('textoNo');
const imgGif = document.getElementById('imgGif');
const btnConfirmar = document.getElementById('btnConfirmar');
const btnMejorNo = document.getElementById('btnMejorNo');
const btnVolver = document.getElementById('btnVolver');
const btnVolverPantalla3 = document.getElementById('btnVolverPantalla3');
const btnEntrar = document.getElementById('btnEntrar');
const inputNombre = document.getElementById('inputNombre');
const mensajeError = document.getElementById('mensajeError');
const heartRain = document.getElementById('heartRain');

// Funci√≥n para reproducir sonidos
function reproducirSonido(tipo) {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    if (tipo === 'si') {
        // Sonido alegre para S√ç
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        
        osc.connect(gain);
        gain.connect(audioContext.destination);
        
        osc.frequency.value = 800;
        gain.gain.setValueAtTime(0.3, audioContext.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
        
        osc.start(audioContext.currentTime);
        osc.stop(audioContext.currentTime + 0.1);
        
        // Segunda nota
        setTimeout(() => {
            const osc2 = audioContext.createOscillator();
            const gain2 = audioContext.createGain();
            
            osc2.connect(gain2);
            gain2.connect(audioContext.destination);
            
            osc2.frequency.value = 1000;
            gain2.gain.setValueAtTime(0.3, audioContext.currentTime);
            gain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            osc2.start(audioContext.currentTime);
            osc2.stop(audioContext.currentTime + 0.1);
        }, 100);
        
    } else if (tipo === 'no') {
        // Sonido triste para NO
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        
        osc.connect(gain);
        gain.connect(audioContext.destination);
        
        osc.frequency.setValueAtTime(600, audioContext.currentTime);
        osc.frequency.linearRampToValueAtTime(400, audioContext.currentTime + 0.2);
        gain.gain.setValueAtTime(0.3, audioContext.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
        
        osc.start(audioContext.currentTime);
        osc.stop(audioContext.currentTime + 0.2);
    }
}


let escalaSi = 1;
let primeraVez = true;
let contadorNo = 0;
let isMovingMode = false;
let moveInterval = null;
let pantallActual = 1;



function createHeart() {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.innerHTML = "‚ù§Ô∏è";
    heart.style.left = Math.random() * 100 + "%";
    heart.style.animationDuration = (Math.random() * 4 + 6) + "s";
    heart.style.animationDelay = Math.random() * 5 + "s";
    
    const randomOpacity = Math.random() * 0.4 + 0.4;
    heart.style.setProperty('opacity', randomOpacity);
    
    const randomSize = Math.random() * 15 + 15;
    heart.style.fontSize = randomSize + "px";
    
    heartRain.appendChild(heart);
    
    const duration = parseFloat(heart.style.animationDuration) * 1000;
    const delay = parseFloat(heart.style.animationDelay) * 1000;
    setTimeout(() => {
        heart.remove();
        createHeart();
    }, duration + delay);
}

for (let i = 0; i < 50; i++) {
    createHeart();
}

function normalizarTexto(texto) {
    return texto.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase().trim();
}

function validarAcceso() {
    const nombreIngresado = normalizarTexto(inputNombre.value);
    const nombreCorrecto = normalizarTexto("andrea carolina velazquez baez");
    
    if (nombreIngresado === nombreCorrecto) {
        mensajeError.style.display = 'none';
        reproducirSonido('si');
        cambiarPantalla(1);
        inputNombre.value = '';
    } else {
        reproducirSonido('no');
        mensajeError.style.display = 'block';
        mensajeError.innerHTML = '‚ùå Nombre incorrecto. Solo personas autorizadas.';
        inputNombre.value = '';
        inputNombre.focus();
    }
}

function cambiarPantalla(num) {
    document.querySelectorAll('.pantalla').forEach(p => {
        p.classList.remove('activa');
        p.classList.remove('zoom-in');
    });
    const pantalla = document.getElementById('pantalla' + num);
    pantalla.classList.add('activa');
    
    // Rastrear pantalla actual
    pantallActual = num;
    
    // Agregar zoom solo a pantalla 3
    if (num === 3) {
        pantalla.classList.add('zoom-in');
    }
}

function mostrarInvitacion() {
    reproducirSonido('si');
    cambiarPantalla(2);
}

function mostrarDetallesCita() {
    reproducirSonido('si');
    cambiarPantalla(3);
}

function mostrarGifTriste() {
    reproducirSonido('no');
    cambiarPantalla(4);
}

function volverAtras() {
    reproducirSonido('si');
    
    // Retroceder una pantalla
    const pantallasValidas = {
        2: 1,  // De invitaci√≥n va a inicio
        3: 1,  // De ubicaci√≥n va a inicio
        4: 1   // De rechazo va a inicio
    };
    
    if (pantallasValidas[pantallActual]) {
        const nuevaPantalla = pantallasValidas[pantallActual];
        
        // Resetear todo si volvemos a pantalla 1
        if (nuevaPantalla === 1) {
            contadorNo = 0;
            escalaSi = 1;
            primeraVez = true;
            isMovingMode = false;
            if (moveInterval) clearInterval(moveInterval);
            
            const botonesExplosion = document.querySelectorAll('.btn-si-flood');
            botonesExplosion.forEach(btn => btn.remove());
            
            btnSi.style.transform = 'scale(1)';
            btnSi.style.opacity = '1';
            btnSi.style.pointerEvents = 'auto';
            btnNo.style.opacity = '1';
            btnNo.style.pointerEvents = 'auto';
            btnNo.style.position = 'relative';
            btnNo.style.left = '0';
            btnNo.style.top = '0';
            btnNo.style.transform = 'scale(1)';
            btnNo.classList.remove('moving');
            
            imgGif.src = "https://i.ibb.co/Gfkxj1m4/Grabacindepantalla2026-02-08212818-ezgif-com-video-to-gif-converter.gif";
            textoNo.style.display = 'none';
            textoNo.innerHTML = '';
        }
        
        cambiarPantalla(nuevaPantalla);
    }
}

function shakeCard() {
    const cardContent = document.querySelector(".card-content");
    cardContent.classList.add('shake');
    setTimeout(() => {
        cardContent.classList.remove('shake');
    }, 500);
}

function activarNo() {
    reproducirSonido('no');
    contadorNo++;
    textoNo.style.display = "block";
    shakeCard();

    if (contadorNo >= 5) {
        imgGif.src = "https://i.ibb.co/HfLzQ44X/ezgif-com-loop-count.gif";
        textoNo.innerHTML = "Solo bot√≥n S√≠ disponible üíï";
    } else if (contadorNo >= 4) {
        imgGif.src = "https://i.ibb.co/b560P9cq/Grabacin2026-02-08233029-ezgif-com-video-to-gif-converter.gif";
        textoNo.innerHTML = "¬°YA BASTA POR FAVOR! üò≠üíî";
    } else if (contadorNo >= 3) {
        textoNo.innerHTML = "¬°YA BASTA! üíî ¬°AHORA TEN√âS QUE ATRAPARME! üî•";
        imgGif.src = "https://i.ibb.co/0LT5Mcb/ezgif-com-animated-gif-maker.gif";
        if (!isMovingMode) activarModoMovimientoLibre();
    } else if (contadorNo >= 2) {
        textoNo.innerHTML = "¬øPOR QU√â DECIS NO TODAVIA? üò≠üíî";
        imgGif.src = "https://i.ibb.co/vCBmPXbx/STK-20250727-WA0007.webp";
    } else {
        textoNo.innerHTML = "¬øPOR QU√â APRET√ÅS EL NO? üò≠";
        imgGif.src = "https://i.ibb.co/C5dZstcx/Grabacindepantalla2026-02-08212636-ezgif-com-video-to-gif-converter.gif";
    }

    imgGif.style.display = 'none';
    imgGif.offsetHeight;
    imgGif.style.display = 'block';

    escalaSi = Math.min(escalaSi * 1.25, 3.5);
    btnSi.style.transform = `scale(${escalaSi})`;

    if (contadorNo === 5) {
        btnNo.style.opacity = '0';
        btnNo.style.pointerEvents = 'none';
    } else {
        // El bot√≥n No mantiene su tama√±o original
        btnNo.style.transform = `scale(1)`;
    }

    if (primeraVez && contadorNo >= 1) {
        btnNo.style.position = "fixed";
        btnNo.style.left = (window.innerWidth / 2 - btnNo.offsetWidth / 2) + 'px';
        btnNo.style.top = (window.innerHeight / 2 + 80) + 'px';
        primeraVez = false;
    }

    if (!isMovingMode && contadorNo < 3) {
        const x = Math.random() * (window.innerWidth - btnNo.offsetWidth - 100) + 50;
        const y = Math.random() * (window.innerHeight - btnNo.offsetHeight - 100) + 50;
        btnNo.style.left = `${x}px`;
        btnNo.style.top = `${y}px`;
    }

    if (contadorNo === 5) {
        btnSi.style.transform = `scale(0)`;
        btnSi.style.opacity = '0';
        btnSi.style.pointerEvents = 'none';
        
        // Crear explosi√≥n de 200 botones S√≠
        setTimeout(() => {
            const pantalla1 = document.getElementById('pantalla1');
            const card = pantalla1.querySelector('.card');
            const cardRect = card.getBoundingClientRect();
            const colores = ['#f06292', '#ec407a', '#e91e63', '#c2185b', '#ff80ab', '#ff4081', '#d81b60'];
            
            for (let i = 0; i < 200; i++) {
                setTimeout(() => {
                    const btnFlood = document.createElement('button');
                    btnFlood.className = 'btn-si-flood';
                    btnFlood.textContent = '¬°S√ç!';
                    btnFlood.style.backgroundColor = colores[Math.floor(Math.random() * colores.length)];
                    
                    const randomOriginX = 5 + Math.random() * (cardRect.width - 10);
                    const randomOriginY = 10 + Math.random() * (cardRect.height - 80);
                    
                    btnFlood.style.left = randomOriginX + 'px';
                    btnFlood.style.top = randomOriginY + 'px';
                    
                    const direccion = i < 100 ? -1 : 1;
                    const baseAngle = direccion === -1 ? 180 : 0;
                    const angle = (baseAngle + (Math.random() * 90 - 45)) * (Math.PI / 180);
                    
                    const explodeDistance = 120 + Math.random() * 250;
                    const explodeX = Math.cos(angle) * explodeDistance;
                    const explodeY = -Math.abs(Math.sin(angle) * explodeDistance * 0.5);
                    const finalX = explodeX * 0.8 + (Math.random() - 0.5) * 80;
                    const finalY = cardRect.height - randomOriginY - 40 + (Math.random() * 35);
                    const rotation = Math.random() * 1440 - 720;
                    
                    btnFlood.style.setProperty('--explode-x', `${explodeX}px`);
                    btnFlood.style.setProperty('--explode-y', `${explodeY}px`);
                    btnFlood.style.setProperty('--final-x', `${finalX}px`);
                    btnFlood.style.setProperty('--final-y', `${finalY}px`);
                    btnFlood.style.setProperty('--rotate', `${rotation}deg`);
                    
                    btnFlood.style.animationDelay = (i * 0.003) + 's';
                    btnFlood.style.animationDuration = (Math.random() * 0.6 + 1.8) + 's';
                    
                    btnFlood.addEventListener('click', () => {
                        reproducirSonido('si');
                        mostrarInvitacion();
                    });
                    
                    card.appendChild(btnFlood);
                }, i * 5);
            }
        }, 0);
    }
}

function activarModoMovimientoLibre() {
    isMovingMode = true;
    btnNo.classList.add('moving');
    let dx = (Math.random() > 0.5 ? 1 : -1) * (150 + Math.random() * 150);
    let dy = (Math.random() > 0.5 ? 1 : -1) * (80 + Math.random() * 80);
    
    let velocidadMultiplicador = contadorNo >= 5 ? 4.5 : 2.35;
    
    moveInterval = setInterval(() => {
        if (!isMovingMode) return;
        let currentLeft = parseFloat(btnNo.style.left) || window.innerWidth / 2;
        let currentTop = parseFloat(btnNo.style.top) || window.innerHeight / 2;
        currentLeft += dx * 0.016 * velocidadMultiplicador;
        currentTop += dy * 0.016 * velocidadMultiplicador;
        if (currentLeft < 30 || currentLeft > window.innerWidth - btnNo.offsetWidth - 30) {
            dx = -dx * (1.0 + Math.random() * 0.3);
            dy += (Math.random() - 0.5) * 20;
        }
        if (currentTop < 30 || currentTop > window.innerHeight - btnNo.offsetHeight - 30) {
            dy = -dy * (1.0 + Math.random() * 0.3);
            dx += (Math.random() - 0.5) * 40;
        }
        if (Math.random() < 0.06) {
            dx = (Math.random() > 0.5 ? 1 : -1) * (140 + Math.random() * 140);
            dy = (Math.random() > 0.5 ? 1 : -1) * (70 + Math.random() * 90);
        }
        btnNo.style.left = `${Math.max(30, Math.min(window.innerWidth - btnNo.offsetWidth - 30, currentLeft))}px`;
        btnNo.style.top = `${Math.max(30, Math.min(window.innerHeight - btnNo.offsetHeight - 30, currentTop))}px`;
    }, 12);
}

// EVENT LISTENERS
btnEntrar.addEventListener('click', validarAcceso);
btnSi.addEventListener('click', mostrarInvitacion);
btnNo.addEventListener('click', activarNo);
btnConfirmar.addEventListener('click', mostrarDetallesCita);
btnMejorNo.addEventListener('click', mostrarGifTriste);
btnVolver.addEventListener('click', volverAtras);
btnVolverPantalla3.addEventListener('click', volverAtras);

});
</script>
</body>
</html>
