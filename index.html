<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>San Valent铆n</title>
<style>
    body {
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: linear-gradient(135deg, #ffebee 0%, #ffcccb 40%, #ff80ab 70%, #e91e63 100%);
        font-family: Arial, sans-serif;
        overflow: hidden;
        position: relative;
    }
    .heart-rain {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
        overflow: hidden;
    }
    .heart {
        position: absolute;
        font-size: 20px;
        color: #ff69b4;
        opacity: 0.7;
        top: -50px;
        will-change: transform;
        animation: rain linear infinite;
    }
    .heart:nth-child(odd) { 
        color: #c2185b; 
        font-size: 18px; 
    }
    .heart:nth-child(3n) { 
        color: #ff80ab; 
        font-size: 25px; 
        opacity: 0.9; 
    }
    @keyframes rain {
        0% { 
            transform: translateY(0) rotate(0deg); 
            opacity: 0;
        }
        10% {
            opacity: 0.7;
        }
        90% {
            opacity: 0.7;
        }
        100% { 
            transform: translateY(calc(100vh + 100px)) rotate(720deg); 
            opacity: 0;
        }
    }
    .card {
        background: white;
        padding: 40px;
        border-radius: 25px;
        box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        text-align: center;
        width: 420px;
        max-width: 90%;
        position: relative;
        z-index: 10;
        overflow: hidden;
    }
    h1 {
        color: #c2185b;
        font-size: 28px;
        margin-bottom: 10px;
    }
    #textoNo {
        display: none;
        color: #d81b60;
        font-weight: bold;
        margin-top: 15px;
        font-size: 18px;
    }
    img {
        border-radius: 15px;
        margin: 20px auto;
        display: block;
    }
    #imgGif {
        width: 232px !important;
        height: 234px !important;
        object-fit: contain;
        background: #fff;
    }
    .btn-container {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-top: 30px;
    }
    button {
        padding: 14px 35px;
        font-size: 20px;
        font-weight: bold;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: transform 0.4s ease, opacity 0.8s ease;
        position: relative;
    }
    #btnSi {
        background-color: #f06292;
        color: white;
    }
    #btnNo {
        background-color: #90a4ae;
        color: white;
        position: relative;
        transition: left 0.5s ease-out, top 0.5s ease-out, transform 0.3s ease;
        pointer-events: auto;
        z-index: 999;
    }
    #btnNo.moving {
        transition: left 0.25s linear, top 0.25s linear, transform 0.3s ease;
        position: fixed !important;
    }
    .mini-si {
        position: absolute;
        font-size: 1.4rem;
        font-weight: bold;
        color: #f06292;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        pointer-events: none;
        z-index: 1000;
        animation: flyOut 4s forwards;
    }
    @keyframes flyOut {
        0% { opacity: 1; transform: scale(0.6) translate(0,0); }
        100% { opacity: 0; transform: scale(2) translate(var(--tx), var(--ty)); }
    }
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
        20%, 40%, 60%, 80% { transform: translateX(10px); }
    }
    .card-content {
        position: relative;
    }
    .card-content.shake {
        animation: shake 0.5s ease-in-out;
    }
    .btn-si-flood {
        position: absolute;
        padding: 8px 18px;
        font-size: 14px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        color: white;
        z-index: 500;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        will-change: transform, opacity;
        animation: fireworkExplosion 2.5s ease-out forwards;
    }
    @keyframes fireworkExplosion {
        0% { transform: translate(0, 0) scale(0.3) rotate(0deg); opacity: 0; }
        2% { opacity: 1; transform: translate(calc(var(--explode-x) * 0.03), calc(var(--explode-y) * 0.03)) scale(0.4) rotate(15deg); }
        5% { transform: translate(calc(var(--explode-x) * 0.08), calc(var(--explode-y) * 0.1)) scale(0.6) rotate(35deg); }
        8% { transform: translate(calc(var(--explode-x) * 0.15), calc(var(--explode-y) * 0.2)) scale(0.8) rotate(60deg); }
        12% { transform: translate(calc(var(--explode-x) * 0.23), calc(var(--explode-y) * 0.32 - 10px)) scale(0.95) rotate(95deg); }
        16% { transform: translate(calc(var(--explode-x) * 0.33), calc(var(--explode-y) * 0.45 - 18px)) scale(1) rotate(135deg); }
        20% { transform: translate(calc(var(--explode-x) * 0.43), calc(var(--explode-y) * 0.56 - 23px)) scale(1) rotate(180deg); }
        25% { transform: translate(calc(var(--explode-x) * 0.55), calc(var(--explode-y) * 0.64 - 28px)) scale(1) rotate(235deg); }
        30% { transform: translate(calc(var(--explode-x) * 0.67), calc(var(--explode-y) * 0.7 - 31px)) scale(1) rotate(295deg); }
        35% { transform: translate(calc(var(--explode-x) * 0.77), calc(var(--explode-y) * 0.72 - 32px)) scale(1) rotate(360deg); }
        40% { transform: translate(calc(var(--explode-x) * 0.86), calc(var(--explode-y) * 0.7 - 30px)) scale(1) rotate(430deg); }
        45% { transform: translate(calc(var(--explode-x) * 0.93), calc(var(--explode-y) * 0.64 - 25px)) scale(1) rotate(505deg); }
        50% { transform: translate(calc(var(--explode-x) * 0.97), calc(var(--explode-y) * 0.54 - 18px)) scale(1) rotate(580deg); }
        55% { transform: translate(calc(var(--explode-x) * 0.99), calc(var(--explode-y) * 0.4 - 8px)) scale(1) rotate(655deg); }
        60% { transform: translate(calc(var(--explode-x) * 1), calc(var(--explode-y) * 0.23 + 5px)) scale(1) rotate(730deg); }
        65% { transform: translate(calc(var(--explode-x) * 0.99), calc(var(--explode-y) * 0.05 + 20px)) scale(1) rotate(805deg); }
        70% { transform: translate(calc(var(--explode-x) * 0.96), calc(var(--explode-y) * -0.15 + 38px)) scale(1) rotate(880deg); }
        75% { transform: translate(calc(var(--final-x) * 0.5), calc(var(--final-y) * 0.35)) scale(1) rotate(955deg); }
        80% { transform: translate(calc(var(--final-x) * 0.7), calc(var(--final-y) * 0.55)) scale(1) rotate(1030deg); }
        85% { transform: translate(calc(var(--final-x) * 0.85), calc(var(--final-y) * 0.73)) scale(1) rotate(1105deg); }
        90% { transform: translate(calc(var(--final-x) * 0.94), calc(var(--final-y) * 0.87)) scale(1) rotate(1180deg); }
        95% { transform: translate(calc(var(--final-x) * 0.98), calc(var(--final-y) * 0.96)) scale(1) rotate(1255deg); }
        100% { transform: translate(var(--final-x), var(--final-y)) scale(1) rotate(var(--rotate)); opacity: 1; }
    }
</style>
</head>
<body>
<div class="heart-rain" id="heartRain"></div>
<div class="card">
    <div class="card-content">
        <h1 id="titulo">驴Quieres ser mi San Valent铆n? わ</h1>
        <p id="textoNo"></p>
      
        <img
            id="imgGif"
            src="https://i.ibb.co/Gfkxj1m4/Grabacindepantalla2026-02-08212818-ezgif-com-video-to-gif-converter.gif"
            alt="Gif inicial"
        >
    </div>
  
    <div class="btn-container">
        <button id="btnSi">隆S!</button>
        <button id="btnNo">No</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
// Funci贸n para lanzar confetti
function lanzarConfetti() {
    const duracion = 3000;
    const fin = Date.now() + duracion;

    const colores = ['#f06292', '#ec407a', '#e91e63', '#c2185b', '#ff80ab', '#ff4081'];

    (function frame() {
        confetti({
            particleCount: 5,
            angle: 60,
            spread: 55,
            origin: { x: 0 },
            colors: colores
        });
        confetti({
            particleCount: 5,
            angle: 120,
            spread: 55,
            origin: { x: 1 },
            colors: colores
        });

        if (Date.now() < fin) {
            requestAnimationFrame(frame);
        }
    }());
}

// Lluvia de corazones mejorada
const heartRain = document.getElementById("heartRain");

function createHeart() {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.innerHTML = "わ";
    heart.style.left = Math.random() * 100 + "%";
    heart.style.animationDuration = (Math.random() * 4 + 6) + "s";
    heart.style.animationDelay = Math.random() * 5 + "s";
    
    const randomOpacity = Math.random() * 0.4 + 0.4;
    heart.style.setProperty('opacity', randomOpacity);
    
    const randomSize = Math.random() * 15 + 15;
    heart.style.fontSize = randomSize + "px";
    
    heartRain.appendChild(heart);
    
    const duration = parseFloat(heart.style.animationDuration) * 1000;
    const delay = parseFloat(heart.style.animationDelay) * 1000;
    setTimeout(() => {
        heart.remove();
        createHeart();
    }, duration + delay);
}

for (let i = 0; i < 50; i++) {
    createHeart();
}

const btnNo = document.getElementById("btnNo");
const btnSi = document.getElementById("btnSi");
const textoNo = document.getElementById("textoNo");
const imgGif = document.getElementById("imgGif");
const container = document.body;
const cardContent = document.querySelector(".card-content");

let escalaSi = 1;
let escalaNo = 1;
let primeraVez = true;
let contadorNo = 0;
let isMovingMode = false;
let moveInterval = null;

function shakeCard() {
    cardContent.classList.add('shake');
    setTimeout(() => {
        cardContent.classList.remove('shake');
    }, 500);
}

function activarNo() {
    contadorNo++;
    textoNo.style.display = "block";
    
    shakeCard();

    if (contadorNo >= 5) {
        imgGif.src = "https://i.ibb.co/bjp4FSRr/STK-20240720-WA0017.webp";
        textoNo.innerHTML = "Solo bot贸n S铆 disponible ";
        // Hacer que el gif se quede visible por m谩s tiempo
        setTimeout(() => {
            imgGif.style.opacity = '1';
        }, 100);
    } else if (contadorNo >= 4) {
        imgGif.src = "https://i.ibb.co/b560P9cq/Grabacin2026-02-08233029-ezgif-com-video-to-gif-converter.gif";
        textoNo.innerHTML = "隆YA BASTA POR FAVOR! ";
    } else if (contadorNo >= 3) {
        textoNo.innerHTML = "隆YA BASTA!  隆AHORA TENS QUE ATRAPARME! ";
        imgGif.src = "https://i.ibb.co/C5dZstcx/Grabacindepantalla2026-02-08212636-ezgif-com-video-to-gif-converter.gif";
        if (!isMovingMode) activarModoMovimientoLibre();
    } else if (contadorNo >= 2) {
        textoNo.innerHTML = "驴POR QU DECIS NO TODAVIA? ";
        imgGif.src = "https://i.ibb.co/C5dZstcx/Grabacindepantalla2026-02-08212636-ezgif-com-video-to-gif-converter.gif";
    } else {
        textoNo.innerHTML = "驴POR QU APRETS EL NO? ";
        imgGif.src = "https://i.ibb.co/C5dZstcx/Grabacindepantalla2026-02-08212636-ezgif-com-video-to-gif-converter.gif";
    }

    imgGif.style.display = 'none';
    imgGif.offsetHeight;
    imgGif.style.display = 'block';

    escalaSi = escalaSi * 1.30;
    btnSi.style.transform = `scale(${escalaSi})`;

    if (contadorNo === 5) {
        // Hacer desaparecer completamente el bot贸n No
        btnNo.style.opacity = '0';
        btnNo.style.pointerEvents = 'none';
        btnNo.style.transition = 'opacity 0.5s ease';
    } else {
        escalaNo = Math.max(0.3, escalaNo * 0.80);
        btnNo.style.transform = `scale(${escalaNo})`;
    }

    if (primeraVez && contadorNo >= 1) {
        btnNo.style.position = "fixed";
        btnNo.style.left = (window.innerWidth / 2 - btnNo.offsetWidth / 2) + 'px';
        btnNo.style.top = (window.innerHeight / 2 + 80) + 'px';
        primeraVez = false;
    }

    if (!isMovingMode && contadorNo < 3) {
        const x = Math.random() * (window.innerWidth - btnNo.offsetWidth - 100) + 50;
        const y = Math.random() * (window.innerHeight - btnNo.offsetHeight - 100) + 50;
        btnNo.style.left = `${x}px`;
        btnNo.style.top = `${y}px`;
    }

    // 5ta oprimida: explosi贸n del bot贸n S铆 + lluvia de botones S铆 que caen
    if (contadorNo === 5) {
        // Hacer desaparecer completamente el bot贸n S铆 original INMEDIATAMENTE
        btnSi.style.transform = `scale(0)`;
        btnSi.style.opacity = '0';
        btnSi.style.transition = 'transform 0.3s ease-out, opacity 0.3s ease-out';
        btnSi.style.pointerEvents = 'none';

        // Esperar solo un momento antes de iniciar la explosi贸n de botones
        setTimeout(() => {
            const card = document.querySelector('.card');
            const cardRect = card.getBoundingClientRect();
            
            const colores = ['#f06292', '#ec407a', '#e91e63', '#c2185b', '#ff80ab', '#ff4081', '#d81b60'];
            
            // Crear botones que explotan desde puntos aleatorios
            for (let i = 0; i < 200; i++) {
                setTimeout(() => {
                    const btnFlood = document.createElement('button');
                    btnFlood.className = 'btn-si-flood';
                    btnFlood.textContent = '隆S!';
                    
                    btnFlood.style.backgroundColor = colores[Math.floor(Math.random() * colores.length)];
                    
                    // ORIGEN ALEATORIO dentro de la tarjeta - ampliado al m谩ximo para cubrir toda la izquierda
                    const randomOriginX = 5 + Math.random() * (cardRect.width - 10);
                    const randomOriginY = 10 + Math.random() * (cardRect.height - 80);
                    
                    // Posici贸n inicial aleatoria
                    btnFlood.style.left = randomOriginX + 'px';
                    btnFlood.style.top = randomOriginY + 'px';
                    
                    // Decidir direcci贸n: mitad izquierda, mitad derecha
                    const direccion = i < 100 ? -1 : 1; // Primera mitad izquierda, segunda mitad derecha
                    
                    // ngulo aleatorio para el lanzamiento inicial hacia el lado correspondiente
                    const baseAngle = direccion === -1 ? 180 : 0; // 180掳 para izquierda, 0掳 para derecha
                    const angle = (baseAngle + (Math.random() * 90 - 45)) * (Math.PI / 180);
                    
                    // Distancia de explosi贸n aleatoria - aumentada para mejor cobertura
                    const explodeDistance = 120 + Math.random() * 250;
                    
                    // Calcular posici贸n de explosi贸n (lanzamiento inicial)
                    const explodeX = Math.cos(angle) * explodeDistance;
                    const explodeY = -Math.abs(Math.sin(angle) * explodeDistance * 0.5); // Forzar hacia arriba
                    
                    // Posici贸n final (ca铆da por gravedad hacia la base) - m谩xima distribuci贸n
                    const finalX = explodeX * 0.8 + (Math.random() - 0.5) * 80;
                    const finalY = cardRect.height - randomOriginY - 40 + (Math.random() * 35);
                    
                    // Rotaci贸n aleatoria final - m谩s amplia y fluida
                    const rotation = Math.random() * 1440 - 720; // De -720 a 720 grados
                    
                    btnFlood.style.setProperty('--explode-x', `${explodeX}px`);
                    btnFlood.style.setProperty('--explode-y', `${explodeY}px`);
                    btnFlood.style.setProperty('--final-x', `${finalX}px`);
                    btnFlood.style.setProperty('--final-y', `${finalY}px`);
                    btnFlood.style.setProperty('--rotate', `${rotation}deg`);
                    
                    // Variaci贸n en el delay para efecto escalonado
                    btnFlood.style.animationDelay = (i * 0.003) + 's';
                    
                    // Variaci贸n en la duraci贸n para simular diferentes pesos/inercias
                    btnFlood.style.animationDuration = (Math.random() * 0.6 + 1.8) + 's';
                    
                    // Al hacer clic en cualquier bot贸n S铆 de la explosi贸n
                    btnFlood.addEventListener('click', () => {
                        if (moveInterval) clearInterval(moveInterval);
                        lanzarConfetti();
                        document.body.innerHTML = `
                            <h1 style="color:#c2185b; text-align:center; margin-top:40vh; font-size:3em; text-shadow: 2px 2px 10px rgba(194,24,91,0.5); animation: pulse 1s ease-in-out infinite;">
                                隆SABA QUE DIRAS QUE S! わ
                            </h1>
                            <style>
                                @keyframes pulse {
                                    0%, 100% { transform: scale(1); }
                                    50% { transform: scale(1.05); }
                                }
                            </style>
                        `;
                    });
                    
                    card.appendChild(btnFlood);
                }, i * 5); // Crear botones muy r谩pido para explosi贸n masiva
            }
        }, 300);
    }
    
    if (contadorNo === 6) {
        textoNo.innerHTML = "隆Eleg铆 cualquier S! ";
    }
}

function activarModoMovimientoLibre() {
    isMovingMode = true;
    btnNo.classList.add('moving');
    let dx = (Math.random() > 0.5 ? 1 : -1) * (150 + Math.random() * 150);
    let dy = (Math.random() > 0.5 ? 1 : -1) * (80 + Math.random() * 80);
    
    let velocidadMultiplicador = contadorNo >= 5 ? 4.5 : 2.35;
    
    moveInterval = setInterval(() => {
        if (!isMovingMode) return;
        let currentLeft = parseFloat(btnNo.style.left) || window.innerWidth / 2;
        let currentTop = parseFloat(btnNo.style.top) || window.innerHeight / 2;
        currentLeft += dx * 0.016 * velocidadMultiplicador;
        currentTop += dy * 0.016 * velocidadMultiplicador;
        if (currentLeft < 30 || currentLeft > window.innerWidth - btnNo.offsetWidth - 30) {
            dx = -dx * (1.0 + Math.random() * 0.3);
            dy += (Math.random() - 0.5) * 20;
        }
        if (currentTop < 30 || currentTop > window.innerHeight - btnNo.offsetHeight - 30) {
            dy = -dy * (1.0 + Math.random() * 0.3);
            dx += (Math.random() - 0.5) * 40;
        }
        if (Math.random() < 0.06) {
            dx = (Math.random() > 0.5 ? 1 : -1) * (140 + Math.random() * 140);
            dy = (Math.random() > 0.5 ? 1 : -1) * (70 + Math.random() * 90);
        }
        btnNo.style.left = `${Math.max(30, Math.min(window.innerWidth - btnNo.offsetWidth - 30, currentLeft))}px`;
        btnNo.style.top = `${Math.max(30, Math.min(window.innerHeight - btnNo.offsetHeight - 30, currentTop))}px`;
    }, 12);
}

btnNo.addEventListener("click", activarNo);
btnNo.addEventListener("touchstart", (e) => {
    e.preventDefault();
    activarNo();
});

btnSi.addEventListener("click", () => {
    if (moveInterval) clearInterval(moveInterval);
    lanzarConfetti();
    document.body.innerHTML = `
        <h1 style="color:#c2185b; text-align:center; margin-top:40vh; font-size:3em; text-shadow: 2px 2px 10px rgba(194,24,91,0.5); animation: pulse 1s ease-in-out infinite;">
            隆SABA QUE DIRAS QUE S! わ
        </h1>
        <style>
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }
        </style>
    `;
});

</script>
</body>
</html>
